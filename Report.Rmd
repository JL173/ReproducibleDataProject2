---
title: 'Project 2'
author: "JL"
date: "02/09/2021"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Synopsis

Storms and other severe weather events can cause both public health and economic problems for communities and municipalities. Many severe events can result in fatalities, injuries, and property damage, and preventing such outcomes to the extent possible is a key concern.

########################### <- summary of findings here

```{r}
library(tidyverse)
library(ggplot2)
library(lubridate)
```

# Loading and Processing the Raw Data

This project involves exploring the U.S. National Oceanic and Atmospheric Administration's (NOAA) storm database. This database tracks characteristics of major storms and weather events in the United States, including when and where they occur, as well as estimates of any fatalities, injuries, and property damage.

```{r}
# Download data
download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2FStormData.csv.bz2", "rawdata.csv.bz2")

# Download documentation for data
download.file("https://d396qusza40orc.cloudfront.net/repdata%2Fpeer2_doc%2Fpd01016005curr.pdf", "rawdata_documentation.pdf", mode = "wb")

# import data into dataframe
raw <- read.csv("rawdata.csv.bz2")
```

The events in the database start in the year 1950 and end in November 2011. In the earlier years of the database there are generally fewer events recorded, most likely due to a lack of good records. More recent years should be considered more complete.

## The Data

The dataframe `raw` has 37 columns and 900,000+ observations across the united states. Here is a brief overview.
```{r}
str(raw)
```

Information that we will explore are

- Location: STATE_, COUNTY, COUNTYNAME, STATE
- Time: BGN_DATE, BGN_TIME
- Event Information: EVTYPE, LENGTH, WIDTH, F, REMARKS
- Damage: FATALITIES, INJURIES, PROPDMG, PROPDMGEXP, CROPDMG, CROPDMGEXP

For LENGTH and WIDTH, this is the path length (in miles and tenths of miles) and maximum path width (in yards) for all tornadoes.

For F, The "Saffir-Simpson Hurricane and Tropical Cyclone Scale" is used

1. Windspeed 64-82 kts (74-95 mph), storm tide: 4-5 FT, Damage: Minor  
2. Windspeed 83-95 kts (96-110 mph), storm tide: 6-8 FT, Damage: Moderate  
3. Windspeed 96-113 kts (111-130 mph), storm tide: 9-12 FT, Damage: Major  
4. Windspeed 114-135 kts (131-155 mph), storm tide: 13-18 FT, Damage: Severe  
5. Windspeed >135 kts (>155 mph), storm tide: >18 FT, Damage: Catastrophic

For REMARKS, this is a description of the event.

For PROPDMGEXP and CROPDMGEXP, characters are used to signify cost of damage and include “K” for thousands, “M” for millions, and “B” for billions.

```{r}
# collect location IDs for reference
locations <- select(raw, "STATE__", "STATE", "COUNTY", "COUNTYNAME")

# trim rawdata to chosen variables
raw <- select(raw, c("STATE__", "COUNTY", "BGN_DATE", "BGN_TIME", "EVTYPE", "LENGTH", "WIDTH", "F", "REMARKS", "FATALITIES", "INJURIES", "PROPDMG", "PROPDMGEXP", "CROPDMG", "CROPDMGEXP"))

# rename columns
colnames(raw) <- c("state_id", "county_id", "start_date", "start_time", "event", "length", "width", "F", "remarks", "fatalities", "injuries", "property_damage", "property_damage_cat", "crop_damage", "crop_damage_cat")

# cast raw into correct types and formats
raw$state_id <- as.integer(raw$state_id)
raw$county_id <- as.integer(raw$county_id)
raw$F <- as.factor(raw$F)
raw$property_damage_cat <- as.factor(raw$property_damage_cat)
raw$crop_damage_cat <- as.factor(raw$crop_damage_cat)

raw$start_date <- as.Date(as.character(
  strptime(raw$start_date, format = "%m/%d/%Y")))

```